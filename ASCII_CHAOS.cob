       IDENTIFICATION DIVISION.
       PROGRAM-ID. ASCII-CHAOS.
      * ><^ GNU TERRY PRATCHETT
      * WONKY: RANDOM ASCII ART GENERATOR
      * DODECAGONE SYSTEMS 2026
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-ROW             PIC 99.
       01  WS-COL             PIC 99.
       01  WS-RAND            PIC V9(4).
       01  WS-PICK            PIC 99.
       01  WS-SEED            PIC 9(8).
       01  WS-TEMP            PIC 9(4).
       01  WS-OUTPUT          PIC X(80).
       01  WS-POS             PIC 999.
       01  WS-FRAME           PIC 99.
       01  WS-DENSITY         PIC V9(2).
       01  WS-HEIGHT          PIC 99 VALUE 20.
       01  WS-WIDTH           PIC 99 VALUE 60.
       01  WS-CHARSET         PIC X(32)
           VALUE "/\|_-=+*#@%&!?<>(){}[]~^:.;,`'".
       01  WS-ONE-CHAR        PIC X.
       01  WS-BORDER-LINE     PIC X(62).
       01  WS-TITLE-LINE      PIC X(62).
       01  WS-BLANK-TEST      PIC V9(4).
       PROCEDURE DIVISION.
       MAIN-PARA.
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SEED
           COMPUTE WS-RAND = FUNCTION RANDOM(WS-SEED)
           PERFORM VARYING WS-FRAME FROM 1 BY 1
               UNTIL WS-FRAME > 5
               COMPUTE WS-RAND = FUNCTION RANDOM
               COMPUTE WS-DENSITY = WS-RAND * 0.6 + 0.2
               DISPLAY SPACES
               MOVE ALL "=" TO WS-BORDER-LINE
               DISPLAY "+" WS-BORDER-LINE "+"
               MOVE SPACES TO WS-TITLE-LINE
               STRING
                   "  SPECIMEN " DELIMITED SIZE
                   WS-FRAME DELIMITED SIZE
                   " // DENSITY: " DELIMITED SIZE
                   WS-DENSITY DELIMITED SIZE
                   "  '><^'" DELIMITED SIZE
                   INTO WS-TITLE-LINE
               END-STRING
               DISPLAY "|" WS-TITLE-LINE "|"
               DISPLAY "+" WS-BORDER-LINE "+"
               PERFORM VARYING WS-ROW FROM 1 BY 1
                   UNTIL WS-ROW > WS-HEIGHT
                   MOVE SPACES TO WS-OUTPUT
                   MOVE 1 TO WS-POS
                   PERFORM VARYING WS-COL FROM 1 BY 1
                       UNTIL WS-COL > WS-WIDTH
                       COMPUTE WS-RAND = FUNCTION RANDOM
                       COMPUTE WS-BLANK-TEST =
                           FUNCTION RANDOM
                       IF WS-BLANK-TEST < WS-DENSITY
                           COMPUTE WS-TEMP =
                               FUNCTION INTEGER(
                               WS-RAND * 1000)
                           COMPUTE WS-PICK =
                               FUNCTION MOD(WS-TEMP, 30)
                               + 1
                           MOVE WS-CHARSET(WS-PICK:1)
                               TO WS-ONE-CHAR
                           MOVE WS-ONE-CHAR
                               TO WS-OUTPUT(WS-POS:1)
                       END-IF
                       ADD 1 TO WS-POS
                   END-PERFORM
                   DISPLAY "|" WS-OUTPUT(1:WS-WIDTH)
                       "  |"
               END-PERFORM
               DISPLAY "+" WS-BORDER-LINE "+"
           END-PERFORM
           DISPLAY SPACES
           DISPLAY "GENERATED BY ASCII-CHAOS.COB"
           DISPLAY "'><^' GNU TERRY PRATCHETT"
           STOP RUN.
